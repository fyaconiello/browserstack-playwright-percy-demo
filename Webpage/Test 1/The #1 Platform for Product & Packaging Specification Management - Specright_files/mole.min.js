var session=new getSessionData,mole=function(e,i){switch(e){case"setDomain":session.domain=i;break;case"setNames":insertData.prototype.names=i;break;case"setQueryNames":insertData.prototype.queryStringNames=i;break;case"setExcludeForms":insertData.prototype.excludeForms=[];for(var t=0;t<i.length;t++)insertData.prototype.excludeForms.push(document.querySelectorAll(i[t]));break;case"setDateFormat":insertData.prototype.dateFormat=i;break;case"saveSession":(session.new_user()||session.new_session())&&saveData();break;case"processForms":"marketo"==i&&(insertData.prototype.forms_e=MktoForms2.allForms(),insertData.prototype.addFields=function(e,i){e.addHiddenFields(i)}),new insertData().init("forms");break;case"addQueryStrings":insertData.prototype.ele=i,new insertData().init("queryStrings")}};function getSessionData(){this.domain=this.domain||window.location.hostname.replace("www.",""),this.timestamp=new Date().getTime(),this.referrer_url=function(e){var i=document.referrer,t=i.split("/")[2];return void 0!==i&&"undefined"!==i&&""!==i&&-1==i.indexOf(this.domain)&&(e?t:i)},this.timeout=18e5,this.cookie_expires=function(){var e=new Date;return e.setTime(e.getTime()+31536e6),"expires="+e.toUTCString()},this.organic_sources=["google","daum","eniro","naver","yahoo","msn","bing","aol","lycos","ask","altavista","netscape","cnn","about","mamma","alltheweb","voila","virgilio","live","baidu","alice","yandex","najdi","mama","seznam","search","wirtulana polska","onetcenter","szukacz","yam","pchome","kvasir","sesam","ozu","terra","mynet","ekolay","rambler"],this.social_sources=["facebook","pinterest","twitter","buzzfeed","linkedin","blogger","blogspot","reddit","tumblr","stumbleupon","tinyurl","polyvore","youtube","yelp","cafemom","flickr","paper.li","wordpress","getpocket","weebly","delicious","netvibes","plurk","typepad","vk","allvoices","badoo","disqus","livefyre","d.hatena","t.co","plus.google.com","plus.url.google.com","bookmarks.yahoo.com","answers.yahoo.com"],this.intersection=function(e,i){for(var t=0;t<i.length;t++)if(-1!=e.indexOf(i[t]))return!0;return!1},this.query_string=function e(i,t){return(void 0===t||""===t||"undefined"===t||!1===t)&&(t=this.landing_page()),-1!=t.indexOf("?")&&(-1!=t.indexOf("&"+i,t.indexOf("?"))||-1!=t.indexOf("?"+i,t.indexOf("?")))&&(-1!=t.indexOf("&",t.search("&"+i)+("&"+i).length)?decodeURIComponent(t.substring(t.indexOf(i,t.indexOf("?"))+i.length+1,t.indexOf("&",t.search(i)))):decodeURIComponent(t.substring(t.indexOf(i,t.indexOf("?"))+i.length+1)))},this.default_medium=function(){return!1===this.referrer_url()?"none":""!=this.query_string("gclid")&&!1!=this.query_string("gclid")?"paid":this.intersection(this.social_sources,this.referrer_url(!0).split("."))?"social":this.intersection(this.organic_sources,this.referrer_url(!0).split("."))?"organic":"referral"},this.default_source=function(){return"none"==this.default_medium()?"direct":this.referrer_url(!0)},this.default_term=function(){return this.query_string("q",this.referrer_url(!1))?this.query_string("q",this.referrer_url(!1)):"not provided"},this.landing_page=function(){return window.location.href},this.new_user=function(){return!this.readCookie("_orig_data")},this.new_session=function(){var e=this.readCookie("_conv_data");return!!e&&this.timestamp-e.timestamp>this.timeout},this.readCookie=function(e){for(var i,t=document.cookie.split(";"),r=0;r<t.length;r++)if(0==(i=0==t[r].indexOf(" ")?t[r].substring(1):t[r]).indexOf(e+"="))return JSON.parse(i.substring(e.length+1));return!1}}function saveData(){var e={timestamp:session.timestamp,source:"",medium:"",content:session.query_string("utm_content"),campaign:session.query_string("utm_campaign"),term:"",landing_page:session.landing_page(),gclid:session.query_string("gclid")};return session.query_string("utm_source")?e.source=session.query_string("utm_source"):e.source=session.default_source(),session.query_string("utm_medium")?e.medium=session.query_string("utm_medium"):e.medium=session.default_medium(),session.query_string("utm_term")?e.term=session.query_string("utm_term"):e.term=session.default_term(),session.new_user()?(document.cookie="_conv_data="+JSON.stringify(e)+";"+session.cookie_expires()+"; path=/;domain=."+session.domain+"; SameSite=Lax",document.cookie="_orig_data="+JSON.stringify(e)+";"+session.cookie_expires()+"; path=/;domain=."+session.domain+"; SameSite=Lax"):session.new_session()&&(document.cookie="_conv_data="+JSON.stringify(e)+";"+session.cookie_expires()+"; path=/;domain=."+session.domain+"; SameSite=Lax"),JSON.stringify(e)}function insertData(){this.forms_e=this.forms_e||document.getElementsByTagName("form"),this.excludeForms=this.excludeForms||!1,this.ele=this.ele||document.getElementsByTagName("a"),this.names=this.names||{converting_timestamp:"converting_timestamp",converting_source:"converting_source",converting_medium:"converting_medium",converting_content:"converting_content",converting_campaign:"converting_campaign",converting_term:"converting_term",converting_landing_page:"converting_landing_page",converting_gclid:"converting_gclid",original_timestamp:"original_timestamp",original_source:"original_source",original_medium:"original_medium",original_content:"original_content",original_campaign:"original_campaign",original_term:"original_term",original_landing_page:"original_landing_page",original_gclid:"original_gclid"},this.queryStringNames=this.queryStringNames||{converting_timestamp:"converting_timestamp",converting_source:"converting_source",converting_medium:"converting_medium",converting_content:"converting_content",converting_campaign:"converting_campaign",converting_term:"converting_term",converting_landing_page:"converting_landing_page",converting_gclid:"converting_gclid",original_timestamp:"original_timestamp",original_source:"original_source",original_medium:"original_medium",original_content:"original_content",original_campaign:"original_campaign",original_term:"original_term",original_landing_page:"original_landing_page",original_gclid:"original_gclid"},this.dateFormat=this.dateFormat||"Y-m-d H:i:s",this.conv=session.readCookie("_conv_data"),this.orig=session.readCookie("_orig_data"),this.init=function(e){if("forms"==e){if(this.conv&&this.orig)var i=this.compileObj(this.conv,this.orig,this.names);else var t=saveData(),r=JSON.parse(t),n=JSON.parse(t),i=this.compileObj(r,n,this.names);for(var s=0;s<this.forms_e.length;s++){for(var a=!0,o=0;o<this.excludeForms.length;o++)for(var g=0;g<this.excludeForms[o].length;g++)this.excludeForms[o][g].isEqualNode(this.forms_e[s])&&(a=!1);a&&this.addFields(this.forms_e[s],i)}}if("queryStrings"==e){var i=this.compileObj(this.conv,this.orig,this.queryStringNames);for(var c in this.ele)if(this.ele[c].nodeType)this.queryString(this.ele[c],c,i);else for(var o=0;o<this.ele[c].length;o++)if(this.ele[c][o].nodeType)this.queryString(this.ele[c][o],c,i);else for(var s=0;s<this.ele[c][o].length;s++)this.queryString(this.ele[c][o][s],c,i)}},this.compileObj=function(e,i,t){var r={};for(var n in e.timestamp=this.convertTimestamp(e.timestamp),i.timestamp=this.convertTimestamp(i.timestamp),e)e["converting_"+n]=e[n],delete e[n];for(var n in i)i["original_"+n]=i[n],delete i[n];for(var n in e)if(e[n])for(var s in t)n==s&&(r[t[s]]=e[n]);for(var n in i)if(i[n])for(var s in t)n==s&&(r[t[s]]=i[n]);return r},this.convertTimestamp=function(e){var i=new Date(e),t="";switch(this.dateFormat){case"unix":t=i.getTime();break;case"unixM":i.setUTCHours(0,0,0,0),t=i.getTime();break;case"iso":t=i.toISOString();break;default:for(var r=i.getMonth()+1,n=i.getDate(),s=i.getFullYear(),a=i.getHours(),o=i.getMinutes(),g=i.getSeconds(),c=0;c<this.dateFormat.length;c++)switch(this.dateFormat[c]){case"d":1==n.toString().length&&(n="0"+n),t+=n;break;case"j":10>parseInt(n)&&(n=n.toString().replace(/0/g,"")),t+=n;break;case"y":t+=s.toString().slice(-2);break;case"Y":t+=s;break;case"F":t+=["January","February","March","April","May","June","July","August","September","October","November","December"][r];break;case"M":t+=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r];break;case"m":1==r.toString().length&&(r="0"+r),t+=r;break;case"n":10>parseInt(r)&&(r=r.toString().replace(/0/g,"")),t+=r;break;case"G":10>parseInt(a)&&0!=parseInt(a)&&(a=a.toString().replace(/0/g,"")),t+=a;break;case"g":parseInt(a)>12&&(a=parseInt(a)-12),10>parseInt(a)&&0!=parseInt(a)&&(a=a.toString().replace(/0/g,"")),t+=a;break;case"h":parseInt(a)>12&&(a=parseInt(a)-12),1==a.toString().length&&(a="0"+a),t+=a;break;case"H":1==a.toString().length&&(a="0"+a),t+=a;break;case"i":1==o.toString().length&&(o="0"+o),t+=o;break;case"I":10>parseInt(o)&&0!=parseInt(o)&&(o=o.toString().replace(/0/g,"")),t+=o;break;case"s":1==g.toString().length&&(g="0"+g),t+=g;break;case"S":10>parseInt(g)&&0!=parseInt(g)&&(g=g.toString().replace(/0/g,"")),t+=g;break;case"a":if(a>12)var m="pm";else var m="am";t+=m;break;case"A":if(a>12)var m="PM";else var m="AM";t+=m;break;default:t+=this.dateFormat[c]}}return t},this.addFields=this.addFields||function(e,i){for(var t in i)if(e.elements.namedItem(t))e.elements.namedItem(t).value=i[t];else{var r=document.createElement("input");r.type="hidden",r.name=t,r.value=i[t],e.appendChild(r)}},this.queryString=this.queryString||function(e,i,t){if(void 0!==e&&null!=e.getAttribute(i)){var r="",n=e.getAttribute(i);-1==n.indexOf("?")?n+="?":n.indexOf("?")!=n.length-1&&(n+="&");for(var s=Object.keys(t),a=0,o=s.length;a<o;a++){var g=encodeURIComponent(s[a]),c=encodeURIComponent(t[g]);if(!1!=session.query_string(g,n)){var m=n.indexOf(g);if(n.indexOf("&",m)>-1)var l=n.indexOf("&",m);else var l=null;var u=n.substring(m,l),d=r+g+"="+c;n=n.replace(u,d)}else r=r+encodeURIComponent(g)+"="+encodeURIComponent(c),a!=o-1&&(r+="&")}e.setAttribute(i,n+r)}}}